---
title: Authentication Configuration
description: Configure authentication methods including local authentication and OAuth SSO providers for your Memos instance.
---

Memos supports multiple authentication methods to fit different organizational needs. This comprehensive guide covers local authentication and OAuth SSO integration.

## Authentication Methods Overview

<Cards>
  <Card title="Local Authentication" href="#local-authentication" icon="Key">
    Built-in username/password authentication with security features
  </Card>
  <Card title="OAuth Providers" href="#oauth-providers" icon="Users">
    Google, GitHub, Microsoft, and other OAuth 2.0 providers
  </Card>
</Cards>

## Local Authentication

Local authentication is enabled by default and provides a secure foundation for user management. Passwords are securely hashed using bcrypt for storage.

### Basic Configuration

Local authentication settings are configured through the Memos web interface:

1. **Access Workspace Settings**:
   - Log in as an administrator
   - Navigate to Settings → Workspace

2. **Authentication Settings**:
   - **Allow User Registration**: Control whether new users can sign up
   - **Disable Password Authentication**: Option to disable password-based login when using SSO

### Password Security

Memos uses bcrypt hashing with default cost settings for secure password storage. Password policies are not currently configurable through environment variables.

### User Registration

User registration is controlled through workspace settings:

```yaml
# Workspace settings (configured via web interface)
disallow_user_registration: false  # Allow new user signups
disallow_password_auth: false      # Allow password-based authentication
```

## OAuth SSO Providers

Memos supports Single Sign-On (SSO) through OAuth 2.0 identity providers. OAuth providers are configured through the web interface as Identity Providers (IdPs).

### Supported Providers

Memos supports the following OAuth 2.0 providers out of the box:

- **GitHub**: Uses `login` field as identifier
- **GitLab**: Uses `name` field as identifier  
- **Google**: Uses `email` field as identifier
- **Custom OAuth 2.0**: Configurable field mapping

### Configuring Identity Providers

Identity Providers are configured through the Memos web interface:

1. **Access Admin Settings**:
   - Log in as an administrator
   - Navigate to Settings → Identity Providers

2. **Create New Identity Provider**:
   - Click "Add Identity Provider"
   - Select provider type (GitHub, GitLab, Google, or Custom)
   - Configure the following settings:

#### Provider Configuration

```yaml
# Identity Provider Configuration
name: "GitHub"                    # Display name
type: "GITHUB"                     # Provider type
identifier_filter: ""              # Optional regex to restrict users (e.g., "^org-.*")

# OAuth 2.0 Configuration
config:
  client_id: "your-client-id"
  client_secret: "your-client-secret"
  auth_url: "https://github.com/login/oauth/authorize"
  token_url: "https://github.com/login/oauth/access_token"
  user_info_url: "https://api.github.com/user"
  scopes: ["read:user", "user:email"]
  
  # Field mapping for user attributes
  field_mapping:
    identifier: "login"           # Username field
    display_name: "name"          # Display name field
    email: "email"                # Email field
    avatar_url: "avatar_url"      # Avatar URL field
```

#### GitHub Setup

1. **Create GitHub OAuth App**:
   - Go to GitHub Settings → Developer settings → OAuth Apps
   - Click "New OAuth App"
   - Set Authorization callback URL: `https://your-domain.com/api/v1/auth/callback`

2. **Configuration in Memos**:
   ```yaml
   name: "GitHub"
   type: "GITHUB"
   config:
     client_id: "your-github-client-id"
     client_secret: "your-github-client-secret"
     scopes: ["read:user", "user:email"]
     field_mapping:
       identifier: "login"
       display_name: "name"
       email: "email"
       avatar_url: "avatar_url"
   ```

#### GitLab Setup

```yaml
name: "GitLab"
type: "GITLAB"
config:
  client_id: "your-gitlab-client-id"
  client_secret: "your-gitlab-client-secret"
  auth_url: "https://gitlab.com/oauth/authorize"
  token_url: "https://gitlab.com/oauth/token"
  user_info_url: "https://gitlab.com/api/v4/user"
  scopes: ["read_user"]
  field_mapping:
    identifier: "name"
    display_name: "name"
    email: "email"
    avatar_url: "avatar_url"
```

#### Google Setup

```yaml
name: "Google"
type: "GOOGLE"
config:
  client_id: "your-google-client-id.apps.googleusercontent.com"
  client_secret: "your-google-client-secret"
  auth_url: "https://accounts.google.com/o/oauth2/auth"
  token_url: "https://oauth2.googleapis.com/token"
  user_info_url: "https://www.googleapis.com/oauth2/v2/userinfo"
  scopes: ["openid", "profile", "email"]
  field_mapping:
    identifier: "email"
    display_name: "name"
    email: "email"
    avatar_url: "picture"
```

#### Custom OAuth Provider

For custom OAuth 2.0 providers:

```yaml
name: "Company SSO"
type: "CUSTOM"
config:
  client_id: "your-custom-client-id"
  client_secret: "your-custom-client-secret"
  auth_url: "https://sso.company.com/oauth/authorize"
  token_url: "https://sso.company.com/oauth/token"
  user_info_url: "https://sso.company.com/oauth/userinfo"
  scopes: ["openid", "profile", "email"]
  field_mapping:
    identifier: "preferred_username"
    display_name: "name"
    email: "email"
    avatar_url: "picture"
```

### Identifier Filtering

You can restrict access to specific users or organizations using identifier filters:

```yaml
# Allow only users from specific organization
identifier_filter: "^org-.*"

# Allow only specific email domains
identifier_filter: ".*@company\\.com$"

# Allow specific users
identifier_filter: "^(user1|user2|user3)$"
```

### OAuth Flow

The OAuth 2.0 flow works as follows:

1. **Authorization Request**: User clicks SSO button, redirected to provider's auth URL
2. **Callback Handling**: Provider redirects back with authorization code
3. **Token Exchange**: Memos exchanges code for access token
4. **User Info Retrieval**: Fetch user details using access token
5. **User Creation/Login**: Create new user account or authenticate existing user

### User Provisioning

When a user signs in via OAuth for the first time:

- A new user account is automatically created
- User attributes are mapped from the OAuth provider
- The user is assigned the default role (typically "USER")
- Profile information is populated from the provider

### Session Management

OAuth-authenticated users receive the same session management as local users:

- Sessions expire after 14 days of inactivity
- Session information includes client details (IP, User-Agent, etc.)
- Secure cookies with HttpOnly and SameSite flags

## Multi-Factor Authentication

<Callout type="info">
**Note**: Multi-Factor Authentication (MFA) is planned for a future release but is not currently available in Memos.
</Callout>

When implemented, MFA will provide an additional layer of security by requiring users to provide a second form of authentication beyond their password or OAuth login.

### Planned MFA Features

- **TOTP (Time-based One-Time Password)**: Support for authenticator apps like Google Authenticator
- **SMS MFA**: SMS-based verification codes
- **Email MFA**: Email-based verification codes
- **MFA Enforcement**: Require MFA for administrative accounts

## Advanced Authentication Features

### Session Management

Memos implements secure session management with the following characteristics:

#### Session Expiration

- **Sliding Expiration**: Sessions remain valid as long as the user is active
- **Inactivity Timeout**: Sessions expire after 14 days of inactivity
- **Absolute Timeout**: No absolute session duration limit is enforced

#### Session Security

```bash
# Session cookies are configured with security flags
# HttpOnly: Prevents JavaScript access to session cookies
# SameSite: Strict or None depending on HTTPS configuration
# Secure: Set when using HTTPS
```

#### Session Tracking

Memos tracks session information including:

- **Client Information**: IP address, User-Agent, device type, OS, browser
- **Creation Time**: When the session was established
- **Last Access Time**: Last activity timestamp
- **Session ID**: Unique identifier for each session

#### Managing Sessions

Users can view and manage their active sessions through the web interface:

1. **Access Session Management**:
   - Navigate to Settings → Sessions
   - View all active sessions
   - See session details (device, location, last access)

2. **Terminate Sessions**:
   - Click "Revoke" next to unwanted sessions
   - Option to terminate all other sessions

### User Provisioning

#### OAuth User Creation

When users authenticate via OAuth SSO for the first time:

- **Automatic Account Creation**: New user accounts are created automatically
- **Attribute Mapping**: User profile information is populated from OAuth provider
- **Default Role Assignment**: New users receive the "USER" role by default
- **Profile Completion**: Avatar, display name, and email are set from provider

#### Local User Registration

Local user registration can be controlled through workspace settings:

```bash
# Workspace settings (configured via web interface)
disallow_user_registration: false  # Allow new user signups
disallow_password_auth: false      # Allow password-based authentication
```

### Account Security

#### Password Security (Local Authentication)

Memos uses bcrypt hashing for password storage with default cost settings for secure password verification.

#### Role-Based Access Control

Memos implements three user roles:

- **HOST**: Full system access, can manage all users and settings
- **ADMIN**: Administrative access with user management capabilities
- **USER**: Standard user access with personal memo management

#### Access Control

- **API Authentication**: JWT tokens for programmatic access
- **Session Validation**: Automatic session validation on each request
- **Request Interceptor**: ACL middleware validates authentication on protected endpoints

## Authentication Testing

### Test Configuration

Create test scripts to verify authentication setup.

```bash
#!/bin/bash
# test-auth.sh

MEMOS_URL="https://your-memos-domain.com"

echo "Testing authentication methods..."

# Test local login
echo "1. Testing local authentication..."
curl -X POST "$MEMOS_URL/api/v1/auth/signin" \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","password":"testpass"}' \
  -w "HTTP Status: %{http_code}\n"

# Test OAuth endpoints
echo "2. Testing OAuth endpoints..."
curl -I "$MEMOS_URL/api/v1/auth/oauth/github" -w "HTTP Status: %{http_code}\n"
curl -I "$MEMOS_URL/api/v1/auth/oauth/gitlab" -w "HTTP Status: %{http_code}\n"
curl -I "$MEMOS_URL/api/v1/auth/oauth/google" -w "HTTP Status: %{http_code}\n"

# Test callback endpoints
echo "3. Testing OAuth callback endpoints..."
curl -I "$MEMOS_URL/api/v1/auth/callback/github" -w "HTTP Status: %{http_code}\n"
curl -I "$MEMOS_URL/api/v1/auth/callback/gitlab" -w "HTTP Status: %{http_code}\n"
curl -I "$MEMOS_URL/api/v1/auth/callback/google" -w "HTTP Status: %{http_code}\n"
```

### API Authentication Testing

Test JWT token-based API authentication:

```bash
#!/bin/bash
# test-api-auth.sh

MEMOS_URL="https://your-memos-domain.com"

# 1. Obtain access token
echo "Getting access token..."
TOKEN_RESPONSE=$(curl -X POST "$MEMOS_URL/api/v1/auth/signin" \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","password":"testpass"}')

ACCESS_TOKEN=$(echo $TOKEN_RESPONSE | jq -r '.access_token')

# 2. Test API access with token
echo "Testing API access with token..."
curl -X GET "$MEMOS_URL/api/v1/memos" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -w "HTTP Status: %{http_code}\n"
```

### Session Testing

Verify session management:

```bash
#!/bin/bash
# test-session.sh

MEMOS_URL="https://your-memos-domain.com"

# 1. Login and capture session cookie
echo "Testing session creation..."
LOGIN_RESPONSE=$(curl -X POST "$MEMOS_URL/api/v1/auth/signin" \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","password":"testpass"}' \
  -c cookies.txt)

# 2. Test session validation
echo "Testing session validation..."
curl -X GET "$MEMOS_URL/api/v1/auth/me" \
  -b cookies.txt \
  -w "HTTP Status: %{http_code}\n"

# 3. Test session logout
echo "Testing session termination..."
curl -X POST "$MEMOS_URL/api/v1/auth/signout" \
  -b cookies.txt \
  -w "HTTP Status: %{http_code}\n"
```

### Identity Provider Testing

Test OAuth identity provider configuration:

```bash
#!/bin/bash
# test-idp.sh

MEMOS_URL="https://your-memos-domain.com"

# Test identity provider endpoints
echo "Testing identity provider endpoints..."
curl -X GET "$MEMOS_URL/api/v1/idp" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -w "HTTP Status: %{http_code}\n"

# Test OAuth authorization URL generation
echo "Testing OAuth authorization flow..."
curl -X GET "$MEMOS_URL/api/v1/auth/oauth/github" \
  -w "HTTP Status: %{http_code}\n"
```

## Troubleshooting

### Common Issues

#### OAuth Configuration Problems

```bash
# Check OAuth callback URLs
echo "Verify callback URLs:"
echo "GitHub: https://your-domain.com/api/v1/auth/callback/github"
echo "GitLab: https://your-domain.com/api/v1/auth/callback/gitlab"
echo "Google: https://your-domain.com/api/v1/auth/callback/google"

# Test OAuth endpoints
curl -I https://your-domain.com/api/v1/auth/oauth/github
curl -I https://your-domain.com/api/v1/auth/oauth/gitlab
curl -I https://your-domain.com/api/v1/auth/oauth/google
```

#### Session Issues

```bash
# Check session cookie settings
echo "Session troubleshooting:"
echo "- Ensure HTTPS is enabled for secure cookies"
echo "- Check SameSite cookie settings"
echo "- Verify session expiration (14 days inactivity)"

# Test session validation
curl -X GET "https://your-domain.com/api/v1/auth/me" \
  -H "Cookie: user_session=YOUR_SESSION_COOKIE"
```

#### Identity Provider Configuration

```bash
# Validate identity provider configuration
curl -X GET "https://your-domain.com/api/v1/idp" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"

# Test OAuth flow manually
# 1. Visit: https://your-domain.com/api/v1/auth/oauth/github
# 2. Check browser network tab for errors
# 3. Verify callback URL in provider settings
```

### Log Analysis

Monitor authentication logs for troubleshooting.

```bash
# Memos authentication logs
tail -f /var/log/memos/auth.log | grep -E "(login|oauth|session)"

# System authentication logs
tail -f /var/log/auth.log | grep memos

# Filter failed attempts
grep "authentication failed" /var/log/memos/auth.log

# OAuth-specific errors
grep "oauth" /var/log/memos/auth.log

# Session-related events
grep "session" /var/log/memos/auth.log
```

## Next Steps

- [Configure security settings](/docs/configuration/security) for additional protection
- [Set up API authentication](https://memos.apidocumentation.com) for programmatic access
- [Monitor your instance](/docs/configuration) for authentication issues
- [Plan user management](/docs/guides/user-management) workflows
- Configure Identity Providers through the web interface for OAuth SSO
